<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alertas BNB - Precios Reales</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #f0b90b;
            --secondary: #1e2026;
            --accent: #2b3139;
            --text: #eaecef;
            --success: #0ecb81;
            --danger: #f6465d;
            --warning: #f0b90b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--secondary);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: var(--text);
            opacity: 0.8;
        }
        
        .card {
            background-color: var(--accent);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .card h2 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .price-display {
            font-size: 2.5rem;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
        }
        
        .price-up {
            color: var(--success);
        }
        
        .price-down {
            color: var(--danger);
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat-item {
            text-align: center;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .alert-box {
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
            border: 2px solid;
        }
        
        .buy-alert {
            background-color: rgba(14, 203, 129, 0.2);
            border-color: var(--success);
            color: var(--success);
            animation: pulse 2s infinite;
        }
        
        .sell-alert {
            background-color: rgba(246, 70, 93, 0.2);
            border-color: var(--danger);
            color: var(--danger);
            animation: pulse 2s infinite;
        }
        
        .hold-alert {
            background-color: rgba(240, 185, 11, 0.2);
            border-color: var(--warning);
            color: var(--warning);
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .alert-message {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        
        .alert-reason {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            padding: 15px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
            font-size: 1.1rem;
        }
        
        .btn-buy {
            background-color: var(--success);
            color: white;
        }
        
        .btn-sell {
            background-color: var(--danger);
            color: white;
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        button:hover:not(:disabled) {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .alerts-container {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .alert-item {
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-left: 4px solid;
        }
        
        .alert-buy {
            background-color: rgba(14, 203, 129, 0.1);
            border-left-color: var(--success);
        }
        
        .alert-sell {
            background-color: rgba(246, 70, 93, 0.1);
            border-left-color: var(--danger);
        }
        
        .alert-hold {
            background-color: rgba(240, 185, 11, 0.1);
            border-left-color: var(--warning);
        }
        
        .alert-time {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-top: 5px;
        }
        
        .profit-info {
            background-color: rgba(240, 185, 11, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
        }
        
        .profit-info h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .profit-amount {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .profit-positive {
            color: var(--success);
        }
        
        .profit-negative {
            color: var(--danger);
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-online {
            background-color: var(--success);
        }
        
        .status-offline {
            background-color: var(--danger);
        }
        
        .disclaimer {
            background-color: rgba(240, 185, 11, 0.1);
            border: 1px solid var(--warning);
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            font-size: 0.9rem;
            text-align: center;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--accent);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }
        
        .loading {
            opacity: 0.7;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-bell"></i> Alertas BNB - Precios Reales</h1>
            <p class="subtitle">Sistema simple para ganar $30+ con $150</p>
            <p><span class="status-indicator" id="status-indicator"></span> <span id="connection-status">Conectando...</span></p>
        </header>
        
        <div class="card">
            <h2><i class="fas fa-chart-line"></i> Precio Real BNB</h2>
            <div class="price-display" id="current-price">Cargando precio real...</div>
            <div class="stats">
                <div class="stat-item">
                    <div>Cambio 24h</div>
                    <div class="stat-value" id="change-24h">-</div>
                </div>
                <div class="stat-item">
                    <div>Máximo 24h</div>
                    <div class="stat-value" id="high-24h">-</div>
                </div>
                <div class="stat-item">
                    <div>Mínimo 24h</div>
                    <div class="stat-value" id="low-24h">-</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-exclamation-circle"></i> Alerta de Trading</h2>
            <div class="alert-box" id="alert-box">
                <div class="alert-message">Conectando con datos reales...</div>
                <div class="alert-reason" id="alert-reason">Obteniendo información del mercado</div>
            </div>
            
            <div class="profit-info">
                <h3>Objetivo: $30 de Ganancia</h3>
                <div>Ganancia actual: <span class="profit-amount" id="current-profit">$0.00</span></div>
                <div id="profit-status">Esperando datos del mercado...</div>
            </div>
            
            <div class="controls">
                <button class="btn-buy" id="buy-btn" disabled>
                    <i class="fas fa-shopping-cart"></i> Comprar BNB
                </button>
                <button class="btn-sell" id="sell-btn" disabled>
                    <i class="fas fa-dollar-sign"></i> Vender BNB
                </button>
            </div>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-history"></i> Historial de Alertas</h2>
            <div class="alerts-container" id="alerts-container">
                <div class="alert-item alert-hold">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>INICIALIZANDO</strong>
                        <div>Sistema cargando datos reales de BNB</div>
                        <div class="alert-time" id="last-update">-</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="disclaimer">
            <strong>ATENCIÓN:</strong> Esta es una herramienta educativa. Las criptomonedas son volátiles y puedes perder dinero. 
            Nunca inviertas más de lo que estés dispuesto a perder. Precios obtenidos de CoinGecko API.
        </div>
        
        <footer>
            <p>Datos en tiempo real de CoinGecko | No es asesoramiento financiero</p>
        </footer>
    </div>

    <script>
        // Variables del trading
        let currentPrice = 0;
        let bnbBalance = 0;
        let usdBalance = 150;
        let initialInvestment = 150;
        let lastBuyPrice = 0;
        let tradeHistory = [];
        let priceHistory = [];
        let lastAlert = null;
        
        // Elementos del DOM
        const currentPriceElement = document.getElementById('current-price');
        const change24hElement = document.getElementById('change-24h');
        const high24hElement = document.getElementById('high-24h');
        const low24hElement = document.getElementById('low-24h');
        const alertBox = document.getElementById('alert-box');
        const alertReason = document.getElementById('alert-reason');
        const currentProfitElement = document.getElementById('current-profit');
        const profitStatusElement = document.getElementById('profit-status');
        const buyButton = document.getElementById('buy-btn');
        const sellButton = document.getElementById('sell-btn');
        const alertsContainer = document.getElementById('alerts-container');
        const statusIndicator = document.getElementById('status-indicator');
        const connectionStatus = document.getElementById('connection-status');
        const lastUpdateElement = document.getElementById('last-update');
        
        // Inicializar la aplicación
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setInterval(fetchRealPrice, 10000); // Actualizar cada 10 segundos
        });
        
        // Función para inicializar
        async function initializeApp() {
            updateStatus('Conectando a API...', 'offline');
            await fetchRealPrice();
            updateStatus('Conectado - Datos reales', 'online');
            
            // Habilitar botones
            buyButton.disabled = false;
            sellButton.disabled = false;
            
            // Configurar eventos de botones
            buyButton.addEventListener('click', executeBuy);
            sellButton.addEventListener('click', executeSell);
            
            // Generar primera alerta
            generateAlert();
        }
        
        // Función para obtener precio real
        async function fetchRealPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_last_updated_at=true&include_24hr_high=true&include_24hr_low=true');
                const data = await response.json();
                
                if (data && data.binancecoin) {
                    const bnbData = data.binancecoin;
                    
                    // Actualizar precio actual
                    currentPrice = bnbData.usd;
                    
                    // Actualizar interfaz
                    updateUI(bnbData);
                    generateAlert();
                    
                    updateStatus('Datos actualizados', 'online');
                    lastUpdateElement.textContent = new Date().toLocaleTimeString();
                }
            } catch (error) {
                console.error('Error obteniendo precio real:', error);
                updateStatus('Error conectando a API', 'offline');
                
                // Usar datos simulados como fallback
                useFallbackData();
            }
        }
        
        // Función para usar datos de respaldo
        function useFallbackData() {
            // Simular un cambio pequeño basado en el precio anterior
            const changePercent = (Math.random() - 0.5) * 2; // -1% a +1%
            currentPrice = currentPrice > 0 ? currentPrice * (1 + changePercent / 100) : 580;
            
            const fakeData = {
                usd: currentPrice,
                usd_24h_change: (Math.random() - 0.5) * 10, // -5% a +5%
                usd_24h_high: currentPrice * (1 + Math.random() * 0.05), // 0-5% arriba
                usd_24h_low: currentPrice * (1 - Math.random() * 0.05)   // 0-5% abajo
            };
            
            updateUI(fakeData);
            generateAlert();
            updateStatus('Usando datos simulados', 'offline');
            lastUpdateElement.textContent = new Date().toLocaleTimeString() + ' (simulado)';
        }
        
        // Función para actualizar la interfaz
        function updateUI(bnbData) {
            // Actualizar precio
            currentPriceElement.textContent = `$${bnbData.usd.toFixed(2)}`;
            currentPriceElement.className = 'price-display';
            
            // Actualizar cambio 24h
            if (bnbData.usd_24h_change !== undefined) {
                const change24h = bnbData.usd_24h_change;
                change24hElement.textContent = `${change24h.toFixed(2)}%`;
                change24hElement.className = change24h >= 0 ? 'stat-value price-up' : 'stat-value price-down';
            }
            
            // Actualizar máximo y mínimo 24h
            if (bnbData.usd_24h_high) {
                high24hElement.textContent = `$${bnbData.usd_24h_high.toFixed(2)}`;
            }
            
            if (bnbData.usd_24h_low) {
                low24hElement.textContent = `$${bnbData.usd_24h_low.toFixed(2)}`;
            }
            
            // Calcular ganancia actual si tenemos BNB
            if (bnbBalance > 0 && lastBuyPrice > 0) {
                const currentValue = bnbBalance * currentPrice;
                const profit = currentValue - initialInvestment;
                
                currentProfitElement.textContent = `$${profit.toFixed(2)}`;
                currentProfitElement.className = profit >= 0 ? 'profit-amount profit-positive' : 'profit-amount profit-negative';
                
                if (profit >= 30) {
                    profitStatusElement.textContent = "¡OBJETIVO ALCANZADO! Considera vender para asegurar ganancias.";
                    profitStatusElement.style.color = "var(--success)";
                    profitStatusElement.style.fontWeight = "bold";
                } else if (profit >= 15) {
                    profitStatusElement.textContent = "Buen progreso. Continúa monitoreando para alcanzar los $30.";
                    profitStatusElement.style.color = "var(--success)";
                } else if (profit >= 0) {
                    profitStatusElement.textContent = "En ganancias. Espera a que aumenten para alcanzar tu objetivo.";
                    profitStatusElement.style.color = "var(--success)";
                } else {
                    profitStatusElement.textContent = "En pérdidas. Espera una señal de compra para recuperarte.";
                    profitStatusElement.style.color = "var(--danger)";
                }
            } else {
                currentProfitElement.textContent = "$0.00";
                currentProfitElement.className = "profit-amount";
                profitStatusElement.textContent = "Opera siguiendo las alertas para alcanzar tu objetivo";
                profitStatusElement.style.color = "var(--text)";
            }
        }
        
        // Función para actualizar estado de conexión
        function updateStatus(message, status) {
            connectionStatus.textContent = message;
            statusIndicator.className = `status-indicator ${status === 'online' ? 'status-online' : 'status-offline'}`;
        }
        
        // Función para generar alertas basadas en precio real
        function generateAlert() {
            if (currentPrice === 0) return;
            
            const marketSituation = analyzeRealMarket();
            
            // Evitar alertas duplicadas
            if (lastAlert === marketSituation.signal) return;
            lastAlert = marketSituation.signal;
            
            // Generar alerta basada en la situación del mercado
            if (marketSituation.signal === "BUY") {
                alertBox.className = "alert-box buy-alert";
                alertBox.innerHTML = `
                    <div class="alert-message"><i class="fas fa-arrow-up"></i> SEÑAL DE COMPRA</div>
                    <div class="alert-reason">${marketSituation.reason}</div>
                `;
            } else if (marketSituation.signal === "SELL") {
                alertBox.className = "alert-box sell-alert";
                alertBox.innerHTML = `
                    <div class="alert-message"><i class="fas fa-arrow-down"></i> SEÑAL DE VENTA</div>
                    <div class="alert-reason">${marketSituation.reason}</div>
                `;
            } else {
                alertBox.className = "alert-box hold-alert";
                alertBox.innerHTML = `
                    <div class="alert-message"><i class="fas fa-pause"></i> MANTENER POSICIÓN</div>
                    <div class="alert-reason">${marketSituation.reason}</div>
                `;
            }
            
            // Registrar alerta en el historial
            addAlertToHistory(marketSituation.signal, marketSituation.reason);
        }
        
        // Función para analizar el mercado con datos reales
        function analyzeRealMarket() {
            // Análisis simple basado en precio actual y tendencia
            if (bnbBalance === 0) {
                // Estrategia de compra - buscar buenos puntos de entrada
                
                // Si el precio bajó significativamente en 24h, puede ser buena compra
                const change24h = parseFloat(change24hElement.textContent) || 0;
                
                if (change24h < -5) {
                    return {
                        signal: "BUY",
                        reason: "BNB ha bajado " + Math.abs(change24h).toFixed(1) + "% en 24h. Posible rebote."
                    };
                }
                
                // Si está cerca del mínimo de 24h, puede ser buen momento
                const currentLow = parseFloat(low24hElement.textContent.replace('$', '')) || 0;
                if (currentLow > 0 && currentPrice <= currentLow * 1.01) { // Dentro del 1% del mínimo
                    return {
                        signal: "BUY",
                        reason: "Precio cerca del mínimo de 24h. Posible soporte."
                    };
                }
                
                // Si no hay señales claras, mantener
                return {
                    signal: "HOLD",
                    reason: "Esperando mejor oportunidad de compra. Precio actual: $" + currentPrice.toFixed(2)
                };
                
            } else {
                // Estrategia de venta - buscar tomar ganancias
                const profit = (bnbBalance * currentPrice) - initialInvestment;
                const profitPercentage = (profit / initialInvestment) * 100;
                
                // Si alcanzamos el objetivo de $30
                if (profit >= 30) {
                    return {
                        signal: "SELL",
                        reason: "¡OBJETIVO CUMPLIDO! Ganancia: $" + profit.toFixed(2) + " (" + profitPercentage.toFixed(1) + "%)"
                    };
                }
                
                // Si tenemos buena ganancia pero no llegamos a $30
                if (profit >= 15) {
                    return {
                        signal: "HOLD",
                        reason: "Ganancia actual: $" + profit.toFixed(2) + ". Esperando llegar a $30."
                    };
                }
                
                // Si estamos en pérdidas significativas
                if (profit <= -15) {
                    return {
                        signal: "SELL",
                        reason: "Pérdida significativa: $" + Math.abs(profit).toFixed(2) + ". Considera cortar pérdidas."
                    };
                }
                
                // Por defecto, mantener
                return {
                    signal: "HOLD",
                    reason: profit >= 0 ? 
                        "En ganancias: $" + profit.toFixed(2) + ". Objetivo: $30" :
                        "En espera: $" + profit.toFixed(2) + " de pérdida"
                };
            }
        }
        
        // Función para agregar alerta al historial
        function addAlertToHistory(signal, reason) {
            const alertItem = document.createElement('div');
            alertItem.className = `alert-item ${signal === 'BUY' ? 'alert-buy' : signal === 'SELL' ? 'alert-sell' : 'alert-hold'}`;
            
            alertItem.innerHTML = `
                <i class="fas ${signal === 'BUY' ? 'fa-arrow-up' : signal === 'SELL' ? 'fa-arrow-down' : 'fa-pause'}"></i>
                <div>
                    <strong>${signal === 'BUY' ? 'COMPRA' : signal === 'SELL' ? 'VENTA' : 'MANTENER'}</strong>
                    <div>${reason}</div>
                    <div class="alert-time">${new Date().toLocaleTimeString()}</div>
                </div>
            `;
            
            alertsContainer.prepend(alertItem);
            
            // Limitar a 8 alertas en el historial
            if (alertsContainer.children.length > 8) {
                alertsContainer.removeChild(alertsContainer.lastChild);
            }
        }
        
        // Función para ejecutar compra
        function executeBuy() {
            if (usdBalance > 0) {
                const bnbToBuy = usdBalance / currentPrice;
                bnbBalance = bnbToBuy;
                lastBuyPrice = currentPrice;
                usdBalance = 0;
                
                // Registrar en historial
                tradeHistory.push({
                    type: 'BUY',
                    price: currentPrice,
                    amount: bnbToBuy,
                    timestamp: new Date()
                });
                
                // Mostrar confirmación
                alert(`Compra ejecutada: ${bnbToBuy.toFixed(6)} BNB a $${currentPrice.toFixed(2)}`);
                
                // Actualizar interfaz
                updateUI({usd: currentPrice});
                generateAlert();
            } else {
                alert('No tienes saldo suficiente para comprar');
            }
        }
        
        // Función para ejecutar venta
        function executeSell() {
            if (bnbBalance > 0) {
                const usdReceived = bnbBalance * currentPrice;
                const profit = usdReceived - initialInvestment;
                
                usdBalance = usdReceived;
                
                // Registrar en historial
                tradeHistory.push({
                    type: 'SELL',
                    price: currentPrice,
                    amount: bnbBalance,
                    timestamp: new Date()
                });
                
                // Mostrar resultado
                if (profit >= 0) {
                    alert(`Venta ejecutada: ${bnbBalance.toFixed(6)} BNB a $${currentPrice.toFixed(2)}\nGanancia: $${profit.toFixed(2)}`);
                } else {
                    alert(`Venta ejecutada: ${bnbBalance.toFixed(6)} BNB a $${currentPrice.toFixed(2)}\nPérdida: $${Math.abs(profit).toFixed(2)}`);
                }
                
                // Resetear balances
                bnbBalance = 0;
                lastBuyPrice = 0;
                initialInvestment = 150; // Reset para próxima operación
                usdBalance = usdReceived;
                
                // Actualizar interfaz
                updateUI({usd: currentPrice});
                generateAlert();
            } else {
                alert('No tienes BNB para vender');
            }
        }
    </script>
</body>
</html>
